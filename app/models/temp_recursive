    # Справочный массив для дальнейших калькуляций
    by_id = Hash[*objects.map { |o| [o.id, o] }]
    
    # Калькулейт материализед патч!
    by_path = {}    
    path = []    
    objects.each do |o|
      if o.parent_id != path.last
        if path.include?(o.parent_id)
          path.pop while path.last != o.parent_id
        else
          path << o.parent_id
        end
      end
      (by_path[path.dup] ||= []) << o
    end    
    
    tree = []
    by_path.each do |path, o|
      
    end
